(this["webpackJsonpmern-infrastructure"]=this["webpackJsonpmern-infrastructure"]||[]).push([[0],{21:function(e,t,r){},22:function(e,t,r){},25:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),s=r(12),c=r.n(s),i=(r(21),r(5)),o=r(2),u=(r(22),r(3)),l=r.n(u),j=r(6),b="/api/users";function p(e){return d(b,"POST",e)}function h(e){return d("".concat(b,"/login"),"POST",e)}function d(e){return O.apply(this,arguments)}function O(){return O=Object(j.a)(l.a.mark((function e(t){var r,n,a,s,c,i=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>1&&void 0!==i[1]?i[1]:"GET",n=i.length>2&&void 0!==i[2]?i[2]:null,a={method:r},n&&(a.headers={"Content-Type":"application/json"},a.body=JSON.stringify(n)),(s=g())&&(a.headers=a.headers||{},a.headers.Authorization="Bearer ".concat(s)),e.next=8,fetch(t,a);case 8:if(!(c=e.sent).ok){e.next=11;break}return e.abrupt("return",c.json());case 11:throw new Error("Bad Request");case 12:case"end":return e.stop()}}),e)}))),O.apply(this,arguments)}function m(e){return f.apply(this,arguments)}function f(){return(f=Object(j.a)(l.a.mark((function e(t){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(t);case 2:return r=e.sent,localStorage.setItem("token",r),e.abrupt("return",w());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function x(e){return v.apply(this,arguments)}function v(){return(v=Object(j.a)(l.a.mark((function e(t){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(t);case 2:return r=e.sent,localStorage.setItem("token",r),e.abrupt("return",w());case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(){var e=localStorage.getItem("token");return e?JSON.parse(window.atob(e.split(".")[1])).exp<Date.now()/1e3?(localStorage.removeItem("token"),null):e:null}function w(){var e=g();return e?JSON.parse(window.atob(e.split(".")[1])).user:null}var y=r(7),S=r(9),k=r(13),C=r(14),N=r(16),U=r(15),I=r(1),q=function(e){Object(N.a)(r,e);var t=Object(U.a)(r);function r(){var e;Object(k.a)(this,r);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return(e=t.call.apply(t,[this].concat(a))).state={name:"",email:"",password:"",confirm:"",error:""},e.handleSubmit=function(){var t=Object(j.a)(l.a.mark((function t(r){var n,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r.preventDefault(),t.prev=1,delete(n=Object(S.a)({},e.state)).error,delete n.confirm,t.next=7,m(n);case 7:a=t.sent,e.props.setUser(a),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),e.setState({error:"Sign Up Failed - Try Again"});case 14:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e){return t.apply(this,arguments)}}(),e.handleChange=function(t){var r;e.setState((r={},Object(y.a)(r,t.target.name,t.target.value),Object(y.a)(r,"error",""),r))},e}return Object(C.a)(r,[{key:"render",value:function(){var e=this.state.password!==this.state.confirm;return Object(I.jsxs)("div",{children:[Object(I.jsx)("div",{className:"form-container",children:Object(I.jsxs)("form",{autoComplete:"off",onSubmit:this.handleSubmit,children:[Object(I.jsx)("label",{children:"Name"}),Object(I.jsx)("input",{type:"text",name:"name",value:this.state.name,onChange:this.handleChange,required:!0}),Object(I.jsx)("label",{children:"Email"}),Object(I.jsx)("input",{type:"email",name:"email",value:this.state.email,onChange:this.handleChange,required:!0}),Object(I.jsx)("label",{children:"Password"}),Object(I.jsx)("input",{type:"password",name:"password",value:this.state.password,onChange:this.handleChange,required:!0}),Object(I.jsx)("label",{children:"Confirm"}),Object(I.jsx)("input",{type:"password",name:"confirm",value:this.state.confirm,onChange:this.handleChange,required:!0}),Object(I.jsx)("button",{type:"submit",disabled:e,children:"SIGN UP"})]})}),Object(I.jsxs)("p",{className:"error-message",children:["\xa0",this.state.error]})]})}}]),r}(n.Component);function A(e){var t=e.setUser,r=Object(n.useState)({email:"",password:""}),a=Object(i.a)(r,2),s=a[0],c=a[1],o=Object(n.useState)(""),u=Object(i.a)(o,2),b=u[0],p=u[1];function h(e){c(Object(S.a)(Object(S.a)({},s),{},Object(y.a)({},e.target.name,e.target.value))),p("")}function d(){return(d=Object(j.a)(l.a.mark((function e(r){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r.preventDefault(),e.prev=1,e.next=4,x(s);case 4:n=e.sent,t(n),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),p("Log In Failed - Try Again");case 11:case"end":return e.stop()}}),e,null,[[1,8]])})))).apply(this,arguments)}return Object(I.jsxs)("div",{children:[Object(I.jsx)("div",{className:"form-container",onSubmit:function(e){return d.apply(this,arguments)},children:Object(I.jsxs)("form",{autoComplete:"off",children:[Object(I.jsx)("label",{children:"Email"}),Object(I.jsx)("input",{type:"text",name:"email",value:s.email,onChange:h,required:!0}),Object(I.jsx)("label",{children:"Password"}),Object(I.jsx)("input",{type:"password",name:"password",value:s.password,onChange:h,required:!0}),Object(I.jsx)("button",{type:"submit",children:"LOG IN"})]})}),Object(I.jsxs)("p",{className:"error-message",children:["\xa0",b]})]})}function P(e){var t=e.setUser,r=Object(n.useState)(!1),a=Object(i.a)(r,2),s=a[0],c=a[1];return Object(I.jsxs)("main",{children:[Object(I.jsx)("h1",{children:"AuthPage"}),Object(I.jsx)("button",{onClick:function(){return c(!s)},children:s?"Log In":"Sign Up"}),s?Object(I.jsx)(q,{setUser:t}):Object(I.jsx)(A,{setUser:t})]})}var T=r(8);function E(e){return Object(I.jsxs)("nav",{children:[Object(I.jsx)(T.b,{to:"/orders",children:"Order History"}),"\xa0 | \xa0",Object(I.jsx)(T.b,{to:"/orders/new",children:"New Order"}),"\xa0 | \xa0",Object(I.jsxs)("span",{children:["Welcome, ",e.user.name]}),"\xa0 | \xa0",Object(I.jsx)(T.b,{to:"",onClick:function(){localStorage.removeItem("token"),e.setUser(null)},children:"Log Out"})]})}function J(){var e=Object(n.useState)(w()),t=Object(i.a)(e,2),r=t[0],a=t[1];return Object(I.jsx)("main",{className:"App",children:r?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)(E,{user:r,setUser:a}),Object(I.jsx)(o.b,{})]}):Object(I.jsx)(P,{setUser:a})})}c.a.render(Object(I.jsx)(a.a.StrictMode,{children:Object(I.jsx)(T.a,{children:Object(I.jsx)(J,{})})}),document.getElementById("root"))}},[[25,1,2]]]);
//# sourceMappingURL=main.6f4562b3.chunk.js.map